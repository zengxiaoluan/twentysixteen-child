webpackJsonp([1],{"8/8Q":function(e,t){},AvNl:function(e,t){},G1q7:function(e,t){},GFUh:function(e,t){},HSwN:function(e,t){},Kkxn:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),o={name:"App",mounted:function(){var e=document.querySelector("html"),t=window.innerWidth/10;t=t>50?50:t,e.style.fontSize=t+"px"}},s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var a=n("VU/8")(o,s,!1,function(e){n("c2SE")},null,null).exports,r=n("/ocq"),c=n("Xxa5"),u=n.n(c),l=n("exGp"),f=n.n(l),d=n("22C0"),h=n.n(d),v=n("VXRH"),p={props:{ifTitleAndMenuShow:{type:Boolean,default:!1}},methods:{goHome:function(){this.$router.push({name:"home"})}}},m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{attrs:{name:"slide-down"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:this.ifTitleAndMenuShow,expression:"ifTitleAndMenuShow"}],staticClass:"title-wrapper"},[t("div",{staticClass:"left",staticStyle:{cursor:"pointer"},attrs:{title:"Go home"},on:{click:this.goHome}},[t("span",{staticClass:"iconfont icon"},[this._v("")])])])])},staticRenderFns:[]};var g=n("VU/8")(p,m,!1,function(e){n("l8qH")},"data-v-23da330e",null).exports,w={props:{navigation:Object,ifShowContent:Boolean,bookAvailable:Boolean},methods:{jumpTo:function(e){this.$emit("jumpTo",e)}}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"slide-right"}},[n("div",{staticClass:"content"},[e.bookAvailable?n("div",{staticClass:"content-wrapper"},e._l(e.navigation.toc,function(t,i){return n("div",{key:i,staticClass:"content-item",on:{click:function(n){return e.jumpTo(t.href)}}},[n("span",{staticClass:"text"},[e._v(e._s(t.label))])])}),0):n("div",{staticClass:"empty"},[e._v("Loading...")])])])},staticRenderFns:[]};var k={components:{contentView:n("VU/8")(w,S,!1,function(e){n("Kkxn")},"data-v-259cc89f",null).exports},props:{ifTitleAndMenuShow:{type:Boolean,default:!1},fontSizeList:Array,defaultFontSize:Number,themeList:Array,defaultTheme:Number,bookAvailable:{type:Boolean,default:!1},navigation:Object},data:function(){return{ifSettingShow:!1,showTag:0,progress:0,ifShowContent:!1}},methods:{showSetting:function(e){this.ifSettingShow=!0,this.showTag=e,3===this.showTag?(this.ifSettingShow=!1,this.ifShowContent=!0):this.ifSettingShow=!0},hideSetting:function(){this.ifSettingShow=!1},setFontSize:function(e){this.$emit("setFontSize",e)},setTheme:function(e){this.$emit("setTheme",e)},onProgressInput:function(e){this.progress=e,this.$refs.progress.style.backgroundSize=this.progress+"% 100%"},onProgressChange:function(e){this.$emit("onProgressChange",e)},jumpTo:function(e){this.$emit("jumpTo",e)},hideContent:function(){this.ifShowContent=!1}}},C={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu-bar"},[n("transition",{attrs:{name:"slide-up"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.ifTitleAndMenuShow,expression:"ifTitleAndMenuShow"}],staticClass:"menu-wrapper",class:{"hide-box-shadow":e.ifSettingShow||!e.ifTitleAndMenuShow}},[n("div",{staticClass:"icon-wrapper"},[n("span",{staticClass:"iconfont icon icon-menu",on:{click:function(t){return e.showSetting(3)}}},[e._v("")])]),e._v(" "),n("div",{staticClass:"icon-wrapper"},[n("span",{staticClass:"iconfont icon icon-progress",on:{click:function(t){return e.showSetting(2)}}},[e._v("")])]),e._v(" "),n("div",{staticClass:"icon-wrapper"},[n("span",{staticClass:"iconfont icon icon-bright",on:{click:function(t){return e.showSetting(1)}}},[e._v("")])]),e._v(" "),n("div",{staticClass:"icon-wrapper"},[n("span",{staticClass:"iconfont icon icon-font",on:{click:function(t){return e.showSetting(0)}}},[e._v("")])])])]),e._v(" "),n("transition",{attrs:{name:"slide-up"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.ifSettingShow,expression:"ifSettingShow"}],staticClass:"setting-wrapper"},[0===e.showTag?n("div",{staticClass:"setting-font-size"},[n("div",{staticClass:"preview",style:{fontSize:e.fontSizeList[0].fontSize+"px"}},[e._v("A")]),e._v(" "),n("div",{staticClass:"select"},e._l(e.fontSizeList,function(t,i){return n("div",{key:i,staticClass:"select-wrapper",on:{click:function(n){return e.setFontSize(t.fontSize)}}},[n("div",{staticClass:"line"}),e._v(" "),n("div",{staticClass:"point-wrapper"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.defaultFontSize===t.fontSize,expression:"defaultFontSize===item.fontSize"}],staticClass:"point"},[n("div",{staticClass:"small-point"})])]),e._v(" "),n("div",{staticClass:"line"})])}),0),e._v(" "),n("div",{staticClass:"preview",style:{fontSize:e.fontSizeList[e.fontSizeList.length-1].fontSize+"px"}},[e._v("A")])]):1===e.showTag?n("div",{staticClass:"setting-theme"},e._l(e.themeList,function(t,i){return n("div",{key:i,staticClass:"setting-theme-item",on:{click:function(t){return e.setTheme(i)}}},[n("div",{staticClass:"preview",class:{"no-border":"#fff"!==t.style.body.background},style:{background:t.style.body.background}}),e._v(" "),n("div",{staticClass:"text",class:{selected:i===e.defaultTheme}},[e._v(e._s(t.name))])])}),0):2===e.showTag?n("div",{staticClass:"setting-progress"},[n("div",{staticClass:"progress-wrapper"},[n("input",{ref:"progress",staticClass:"progress",attrs:{type:"range",max:"100",min:"0",step:"1",disabled:!e.bookAvailable},domProps:{value:e.progress},on:{change:function(t){return e.onProgressChange(t.target.value)},input:function(t){return e.onProgressInput(t.target.value)}}})]),e._v(" "),n("div",{staticClass:"text-wrapper"},[n("span",[e._v(e._s(e.bookAvailable?e.progress+"%":"loading..."))])])]):e._e()])]),e._v(" "),n("content-view",{directives:[{name:"show",rawName:"v-show",value:e.ifShowContent,expression:"ifShowContent"}],attrs:{ifShowContent:e.ifShowContent,navigation:e.navigation,bookAvailable:e.bookAvailable},on:{jumpTo:e.jumpTo}}),e._v(" "),n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.ifShowContent,expression:"ifShowContent"}],staticClass:"content-mask",on:{click:e.hideContent}})])],1)},staticRenderFns:[]};var b={components:{TitleBar:g,MenuBar:n("VU/8")(k,C,!1,function(e){n("HSwN")},"data-v-c9c3aba8",null).exports},data:function(){return{currentBookName:"",ifTitleAndMenuShow:!1,fontSizeList:[{fontSize:12},{fontSize:14},{fontSize:16},{fontSize:18},{fontSize:20},{fontSize:22},{fontSize:24}],defaultFontSize:16,themeList:[{name:"default",style:{body:{color:"#000",background:"#fff"}}},{name:"eye",style:{body:{color:"#000",background:"#ceeaba"}}},{name:"night",style:{body:{color:"#fff",background:"#000"}}},{name:"gold",style:{body:{color:"#000",background:"rgb(241,236,226)"}}}],defaultTheme:0,bookAvailable:!1,navigation:null}},methods:{showEpub:function(){var e=this;return f()(u.a.mark(function t(){var n,i,o,s;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.book=new v.a,n=e.$route.query.bookName||void 0,e.currentBookName=n,t.next=5,h.a.getItem(n);case 5:(i=t.sent)||(alert("Book not exists."),e.$router.push({name:"home"})),o=document.getElementById("center"),e.book.open(i),e.rendition=e.book.renderTo("read",{width:o.offsetWidth,height:o.offsetHeight,allowScriptedContent:!0}),s=e.$route.query.cfi||void 0,e.rendition.display(s),e.themes=e.rendition.themes,e.setFontSize(e.defaultFontSize),e.registerTheme(),e.setTheme(e.defaultTheme),e.book.ready.then(function(){return e.navigation=e.book.navigation,e.book.locations.generate()}).then(function(t){e.locations=e.book.locations,e.bookAvailable=!0,e.listenIframeEvent()});case 17:case"end":return t.stop()}},t,e)}))()},listenIframeEvent:function(){var e=this,t=window.frames[0];t.clicked||(console.log("add event"),t.clicked=!0,t.addEventListener("click",function(t){console.log("clicked"),e.toggleTitleAndMenu()}))},prevPage:function(){var e=this;return f()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.rendition.prev();case 2:e.updateCfi();case 3:case"end":return t.stop()}},t,e)}))()},nextPage:function(){var e=this;return f()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.rendition.next();case 2:e.updateCfi();case 3:case"end":return t.stop()}},t,e)}))()},toggleTitleAndMenu:function(){this.ifTitleAndMenuShow=!this.ifTitleAndMenuShow,this.ifTitleAndMenuShow||this.$refs.menuBar.hideSetting()},setFontSize:function(e){this.defaultFontSize=e,this.themes&&this.themes.fontSize(e+"px")},registerTheme:function(){var e=this;this.themeList.forEach(function(t){e.themes.register(t.name,t.style)})},setTheme:function(e){this.themes.select(this.themeList[e].name),this.defaultTheme=e},onProgressChange:function(e){var t=e/100,n=t>0?this.locations.cfiFromPercentage(t):0;this.rendition.display(n)},hideTitleAndMenu:function(){this.ifTitleAndMenuShow=!1,this.$refs.menuBar.hideSetting(),this.$refs.menuBar.hideContent()},jumpTo:function(e){var t=this;return f()(u.a.mark(function n(){return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.rendition.display(e);case 2:t.updateCfi(),t.hideTitleAndMenu(),t.listenIframeEvent();case 5:case"end":return n.stop()}},n,t)}))()},updateCfi:function(){var e=this.rendition.currentLocation().start.cfi;this.$router.replace({query:{cfi:e,bookName:this.currentBookName}}),this.listenIframeEvent()}},mounted:function(){var e=this;setTimeout(function(){e.showEpub()},0);document.addEventListener("keyup",function(t){37==(t.keyCode||t.which)&&e.prevPage(),39==(t.keyCode||t.which)&&e.nextPage()},!1)}},T={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ebook"},[n("title-bar",{attrs:{ifTitleAndMenuShow:e.ifTitleAndMenuShow}}),e._v(" "),n("div",{staticClass:"read-wrapper"},[n("div",{staticClass:"mask"},[n("div",{staticClass:"left",on:{click:e.prevPage}},[e._v("Click for pre page.")]),e._v(" "),n("div",{staticClass:"center",attrs:{id:"center"},on:{click:e.toggleTitleAndMenu}}),e._v(" "),n("div",{staticClass:"right",on:{click:e.nextPage}},[e._v("Click for next page.")])]),e._v(" "),n("div",{attrs:{id:"read"}})]),e._v(" "),n("menu-bar",{ref:"menuBar",attrs:{ifTitleAndMenuShow:e.ifTitleAndMenuShow,fontSizeList:e.fontSizeList,defaultFontSize:e.defaultFontSize,themeList:e.themeList,defaultTheme:e.defaultTheme,bookAvailable:e.bookAvailable,navigation:e.navigation},on:{setFontSize:e.setFontSize,setTheme:e.setTheme,onProgressChange:e.onProgressChange,jumpTo:e.jumpTo}})],1)},staticRenderFns:[]};var _=n("VU/8")(b,T,!1,function(e){n("GFUh"),n("AvNl")},"data-v-4fdfd4c0",null).exports,y={data:function(){return{allBooks:[]}},mounted:function(){var e=this;return f()(u.a.mark(function t(){var n,i;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.keys();case 2:for(n=t.sent,e.allBooks=n,console.log(n),i=0;i<n.length;i++)e.renderBook(i,n[i]);case 6:case"end":return t.stop()}},t,e)}))()},methods:{readThisBook:function(e){this.$router.push({path:"ebook",query:{bookName:e}})},renderBook:function(e,t){var n=this;return f()(u.a.mark(function i(){var o,s;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=new v.a,n.next=3,h.a.getItem(t);case 3:s=n.sent,o.open(s),o.renderTo("viewer-"+e,{width:"100%",height:600}).display();case 7:case"end":return n.stop()}},i,n)}))()},change:function(e){var t,n=(t=f()(u.a.mark(function e(t){var n,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.result,e.next=3,h.a.setItem(o,n);case 3:return e.next=5,h.a.getItem(o);case 5:i=e.sent,location.reload(),a.open(i),a.renderTo("viewer",{width:"100%",height:600}).display();case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)}),i=e.target.files[0];console.log(i);var o=i.name,s=new FileReader;s.onload=n,s.readAsArrayBuffer(i);var a=new v.a}}},x={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e._l(e.allBooks,function(t,i){return[n("div",{key:t+"-outer"},[n("div",{key:t,attrs:{id:"viewer-"+i}}),e._v(" "),n("button",{on:{click:function(n){return e.readThisBook(t)}}},[e._v("Read")])])]}),e._v(" "),n("div",[e._v("\n    Add new book.\n    "),n("input",{attrs:{type:"file"},on:{change:e.change}})])],2)},staticRenderFns:[]};var A=n("VU/8")(y,x,!1,function(e){n("8/8Q")},"data-v-a5870bbe",null).exports;i.a.use(r.a);var z=new r.a({routes:[{name:"home",path:"/",component:A},{path:"/ebook",component:_}]});n("TzC8"),n("G1q7");i.a.config.productionTip=!1,new i.a({el:"#app",router:z,components:{App:a},template:"<App/>"})},TzC8:function(e,t){},c2SE:function(e,t){},l8qH:function(e,t){}},["NHnr"]);